{% extends 'students/base.html' %}

{% load staticfiles my_tags i18n %}
{% block content %}
    <h1>Лабораторная работа: {{ labtask.title }}</h1>
    <div class="lead">
        {{ course }} <br>
        Дедлайн: {{ labtask.deadline|date:"d.m.Y H:i" }}<br>
        {% if user|is_student %}
            <a id="upload-form-expand" class="btn btn-sm btn-default" href="#">Загрузить решение</a>
            <div style="overflow: scroll;">
                <div style="{% if not form.errors %} display: none; {% endif %} margin-top: 10px; width: 700px;"
                     id="upload-form" class="panel panel-default">
                    <div class="panel-body">
                        <form method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ form.media }}
                            {% for field in form %}
                                <div class="form-group {% if field.errors %}has-error{% endif %} ">
                                    {{ field.label_tag }}
                                    {{ field }}
                                    {% if field.errors %}
                                        <div class="help-block">
                                            {{ field.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            <input type="submit" class="btn btn-sm btn-default" value="Загрузить">
                        </form>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
    {% if user|is_teacher %}
        <form method="post" action="{% url 'labtask_action' labtask.id %}">
            {% csrf_token %}
            <button name="action" value="edit" class="btn btn-sm btn-info">
                {{ 'pencil'|fa }} Изменить лабу
            </button>
            <button name="action" value="delete"  class="btn btn-sm btn-danger delete-button">
                {{ 'remove'|fa }} Удалить лабу
            </button>
        </form>
    {% endif %}
    <div>
        {{ labtask.body|safe }}
    </div>
    <script>
        $(document).ready(function () {
            $("#upload-form-expand").on("click", function () {
                $("#upload-form").show();
                $(this).hide();
            });
        })
    </script>
{% endblock %}
